<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Checkout - AgriConnect</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>

    <style>
        :root {
            --primary-color: #2ECC71; --primary-hover: #27ae60; --secondary-color: #16A085;
            --heading-color: #2c3e50; --text-color: #34495e; --light-text: #7f8c8d;
            --bg-color: #ffffff; --alt-bg-color: #f4f7f6; --border-color: #e0e0e0;
            --white-color: #ffffff; --danger-color: #e74c3c;
            --primary-gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.06); --glow-shadow: 0 0 20px rgba(46, 204, 113, 0.3);
            --font-family: 'Inter', sans-serif; --transition-speed: 0.3s; --border-radius: 12px;
        }
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }
        body { font-family: var(--font-family); color: var(--text-color); background-color: var(--alt-bg-color); line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        .app-section { padding: 60px 0; }
        .app-header { background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); padding: 1rem 0; border-bottom: 1px solid #e0e0e0; }
        .app-header .container, .logo { display: flex; align-items: center; }
        .logo { gap: 12px; text-decoration: none; }
        .logo h1 { font-size: 1.6rem; color: var(--heading-color); }
        .card { background: var(--bg-color); border-radius: var(--border-radius); padding: 2.5rem; box-shadow: var(--card-shadow); }
        .btn { display: inline-block; padding: 14px 32px; border-radius: 50px; border: 2px solid transparent; font-size: 1rem; font-weight: 600; cursor: pointer; text-decoration: none; text-align: center; transition: all var(--transition-speed) ease; }
        .btn-primary { background-image: var(--primary-gradient); color: var(--white-color); border: none; }
        .btn-primary:hover { transform: translateY(-4px); box-shadow: var(--glow-shadow); }
        .btn-secondary { background-color: transparent; color: var(--text-color); border-color: var(--border-color); }
        .btn-secondary:hover { background-color: var(--alt-bg-color); }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .form-group input { width: 100%; padding: 12px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1rem; transition: all 0.2s; }
        .form-group input:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.2); }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        input.invalid { border-color: var(--danger-color); }
        
        .checkout-layout { display: grid; grid-template-columns: 2fr 1fr; gap: 2.5rem; align-items: flex-start; }
        .progress-bar { display: flex; justify-content: space-between; margin-bottom: 2.5rem; position: relative; }
        .progress-bar::before { content: ''; position: absolute; top: 50%; left: 0; width: 100%; height: 4px; background-color: var(--border-color); transform: translateY(-50%); z-index: 1; }
        .progress-indicator { position: absolute; top: 50%; left: 0; width: 0%; height: 4px; background-color: var(--primary-color); transform: translateY(-50%); z-index: 2; transition: width 0.5s ease; }
        .progress-step { position: relative; z-index: 3; text-align: center; }
        .step-circle { width: 40px; height: 40px; border-radius: 50%; background-color: var(--bg-color); border: 2px solid var(--border-color); display: flex; align-items: center; justify-content: center; font-weight: 600; transition: all 0.3s ease; }
        .progress-step.active .step-circle { background-color: var(--primary-color); border-color: var(--primary-color); color: var(--white-color); }
        .step-label { margin-top: 0.5rem; font-size: 0.9rem; font-weight: 500; color: var(--light-text); }
        .progress-step.active .step-label { color: var(--heading-color); }
        .checkout-step { display: none; animation: fadeIn 0.5s ease; }
        .checkout-step.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        h4.step-title { font-size: 1.5rem; margin-bottom: 2rem; color: var(--heading-color); border-bottom: 1px solid var(--border-color); padding-bottom: 1rem; }
        .saved-address-grid { display: grid; gap: 1rem; margin-bottom: 1.5rem; }
        .saved-address { padding: 1rem; border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.2s; }
        .saved-address:hover { border-color: var(--primary-hover); background-color: var(--alt-bg-color); }
        .saved-address.selected { border-color: var(--primary-color); background-color: #e8f5e9; box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.2); }
        .saved-address strong { display: block; color: var(--heading-color); }
        .option-group .option-item { padding: 1.25rem; border: 2px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: all 0.2s; margin-bottom: 1rem; }
        .option-group .option-item:hover { border-color: var(--primary-hover); }
        .option-group .option-item.selected { border-color: var(--primary-color); background-color: #e8f5e9; box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.2); }
        .option-item strong { color: var(--heading-color); }
        .payment-details { display: none; padding: 1.5rem; margin-top: 1rem; background: var(--alt-bg-color); border-radius: 8px; border: 1px solid var(--border-color); }
        .order-summary { position: sticky; top: 100px; }
        .summary-item { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
        .summary-item img { width: 60px; height: 60px; object-fit: cover; border-radius: 8px; }
        .summary-item-info { flex-grow: 1; }
        .summary-item-info strong { display: block; }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 0.75rem; }
        .summary-total { font-weight: 700; font-size: 1.2rem; border-top: 1px solid var(--border-color); padding-top: 1rem; margin-top: 1rem; }
        .step-navigation { display: flex; justify-content: space-between; margin-top: 2rem; border-top: 1px solid var(--border-color); padding-top: 2rem; }
        .order-confirmation { text-align: center; padding: 3rem 1rem; }
        .confirmation-icon { width: 80px; height: 80px; background: var(--primary-gradient); color: white; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; margin-bottom: 1.5rem; }
        .order-confirmation h3 { font-size: 2.5rem; color: var(--heading-color); margin-bottom: 0.5rem; }
        .order-confirmation p { font-size: 1.1rem; max-width: 600px; margin: 0 auto 1.5rem auto; }
        .order-confirmation strong { color: var(--primary-color); }
        @media (max-width: 900px) { .checkout-layout { grid-template-columns: 1fr; } .order-summary { position: static; margin-top: 2.5rem; } }
    </style>
</head>
<body>

    <header class="app-header">
        <div class="container">
            <a href="index.html" class="logo">
                <svg width="32" height="32" viewBox="0 0 24 24"><path d="M21.58 9.55c-1.84-3.53-5.02-6.11-8.8-6.53-2.2-.25-4.44.2-6.39 1.28-1.95 1.08-3.51 2.76-4.48 4.79-.31.65-.21 1.41.24 1.95.45.54 1.2.75 1.86.54.66-.21 1.11-.82.9-1.48.79-1.67 2.06-3.03 3.65-3.87 1.59-.84 3.42-1.16 5.25-.9 3.03.43 5.61 2.5 6.96 5.11.39.75 1.22 1.13 2 .85.78-.28 1.25-1.08.97-1.85zM2.42 14.45c1.84 3.53 5.02 6.11 8.8 6.53 2.2.25 4.44-.2 6.39-1.28 1.95-1.08 3.51 2.76 4.48-4.79.31-.65-.21 1.41-.24-1.95-.45-.54-1.2-.75-1.86-.54-.66-.21-1.11.82-.9 1.48-.79 1.67 2.06 3.03-3.65 3.87-1.59-.84-3.42-1.16-5.25-.9-3.03-.43-5.61-2.5-6.96-5.11-.39-.75-1.22-1.13-2-.85-.78-.28-1.25-1.08-.97 1.85z" fill="#2ECC71"></path></svg>
                <h1>AgriConnect</h1>
            </a>
        </div>
    </header>

    <main>
        <section class="app-section">
            <div class="container">
                <div id="checkout-view">
                    <div class="progress-bar">
                        <div class="progress-indicator" id="progress-indicator"></div>
                        <div class="progress-step active" data-step="1"><div class="step-circle">1</div><div class="step-label">Shipping</div></div>
                        <div class="progress-step" data-step="2"><div class="step-circle">2</div><div class="step-label">Payment</div></div>
                        <div class="progress-step" data-step="3"><div class="step-circle">3</div><div class="step-label">Review</div></div>
                    </div>

                    <div class="checkout-layout">
                        <div class="card">
                            <div id="step-1" class="checkout-step active">
                                <h4 class="step-title">Shipping Details</h4>
                                <div id="saved-address-container">
                                    <h5>Your Saved Addresses</h5>
                                    <div id="saved-address-grid" class="saved-address-grid"></div>
                                    <p id="no-saved-address" style="display:none; color: var(--light-text);">You have no saved addresses.</p>
                                </div>
                                <hr style="margin: 2rem 0; border: 0; border-top: 1px solid var(--border-color);">
                                <h5>Enter a New Address</h5>
                                <form id="shipping-form" novalidate>
                                    <div class="form-group"><label for="name">Full Name*</label><input type="text" id="name" required></div>
                                    <div class="form-group"><label for="address">Address Line 1*</label><input type="text" id="address" required></div>
                                    <div class="grid-2">
                                        <div class="form-group"><label for="city">City*</label><input type="text" id="city" required></div>
                                        <div class="form-group"><label for="pincode">Pincode*</label><input type="text" id="pincode" required pattern="\d{6}"></div>
                                    </div>
                                    <div class="form-group"><label for="phone">Mobile Number*</label><input type="tel" id="phone" required placeholder="For delivery updates" pattern="\d{10}"></div>
                                    <div class="form-group"><label style="flex-direction: row; align-items: center; gap: 0.5rem;"><input type="checkbox" id="save-address" style="width: auto;"> Save this address for next time</label></div>
                                </form>
                            </div>

                            <div id="step-2" class="checkout-step">
                                <h4 class="step-title">Delivery & Payment</h4>
                                <div class="option-group" id="delivery-options">
                                    <h5>Delivery Options</h5>
                                    <div class="option-item" data-delivery="Standard" data-cost="150"><strong>Standard Delivery (₹150.00)</strong><p id="standard-delivery-estimate" class="light-text"></p></div>
                                    <div class="option-item" data-delivery="Express" data-cost="300"><strong>Express Delivery (₹300.00)</strong><p id="express-delivery-estimate" class="light-text"></p></div>
                                </div>
                                 <h5 style="margin-top: 2rem;">Payment Method</h5>
                                 <div class="option-group" id="payment-options">
                                     <div class="option-item" data-payment="UPI"><strong>UPI</strong></div>
                                     <div id="UPI-details" class="payment-details">Enter UPI ID: <input type="text" placeholder="yourname@okhdfcbank"></div>
                                     <div class="option-item" data-payment="Credit/Debit Card"><strong>Credit/Debit Card</strong></div>
                                     <div id="Credit/Debit Card-details" class="payment-details">
                                        <div class="form-group"><label>Card Number</label><input type="text"></div>
                                        <div class="grid-2">
                                            <div class="form-group"><label>Expiry (MM/YY)</label><input type="text" placeholder="MM/YY"></div>
                                            <div class="form-group"><label>CVC</label><input type="text"></div>
                                        </div>
                                     </div>
                                     <div class="option-item" data-payment="Cash on Delivery"><strong>Cash on Delivery</strong></div>
                                     <div id="Cash on Delivery-details" class="payment-details"><p>You can pay in cash to our delivery agent upon receipt of your order.</p></div>
                                 </div>
                            </div>

                            <div id="step-3" class="checkout-step">
                                <h4 class="step-title">Review Your Order</h4>
                                <div id="review-shipping"><h5>Shipping To:</h5><p id="review-address-details"></p></div>
                                <hr style="margin: 1.5rem 0; border:0; border-top: 1px solid var(--border-color);">
                                <div id="review-payment"><h5>Payment Method:</h5><p id="review-payment-details"></p></div>
                            </div>

                            <div class="step-navigation">
                                <button class="btn btn-secondary" id="back-btn" style="visibility: hidden;">Back</button>
                                <button class="btn btn-primary" id="next-btn">Next: Payment</button>
                            </div>
                        </div>

                        <aside class="order-summary">
                            <div class="card">
                                <h4>Order Summary</h4>
                                <div id="summary-items-list" style="max-height: 200px; overflow-y: auto; padding-right: 10px;"></div>
                                <hr style="margin: 1rem 0;">
                                <div class="summary-row"><span>Subtotal</span><span id="summary-subtotal">₹0.00</span></div>
                                <div class="summary-row"><span>Shipping</span><span id="summary-shipping">--</span></div>
                                <div class="summary-row"><span>Taxes (5%)</span><span id="summary-tax">₹0.00</span></div>
                                <div class="summary-row summary-total"><span>Total</span><span id="summary-total">₹0.00</span></div>
                            </div>
                        </aside>
                    </div>
                </div>

                <div id="confirmation-view" style="display: none;" class="card">
                     <div class="order-confirmation">
                        <div class="confirmation-icon"><i data-feather="check" style="width: 40px; height: 40px;"></i></div>
                        <h3>Order Placed!</h3>
                        <p>Thank you for your purchase. Your order ID is <strong id="order-id"></strong>. A summary of your order will be sent to WhatsApp.</p>
                        <a href="buy.html" class="btn btn-primary" style="margin-top: 1.5rem;">Continue Shopping</a>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            feather.replace();

            const WHATSAPP_NUMBER = "919019989269";
            const TAX_RATE = 0.05;
            const checkoutView = document.getElementById('checkout-view');
            const confirmationView = document.getElementById('confirmation-view');
            const nextBtn = document.getElementById('next-btn');
            const backBtn = document.getElementById('back-btn');
            const progressIndicator = document.getElementById('progress-indicator');
            const progressSteps = document.querySelectorAll('.progress-step');
            const shippingForm = document.getElementById('shipping-form');

            let checkoutState = { currentStep: 1, cart: [], shippingDetails: {}, deliveryOption: null, paymentMethod: null };

            const formatCurrency = (amount) => `₹${amount.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            const getCart = () => JSON.parse(localStorage.getItem('agriConnectCart')) || [];
            const getSavedAddresses = () => JSON.parse(localStorage.getItem('agriConnectAddresses')) || [];
            const saveAddresses = (addresses) => localStorage.setItem('agriConnectAddresses', JSON.stringify(addresses));

            function renderOrderSummary() {
                const list = document.getElementById('summary-items-list');
                const subtotalEl = document.getElementById('summary-subtotal');
                const shippingEl = document.getElementById('summary-shipping');
                const taxEl = document.getElementById('summary-tax');
                const totalEl = document.getElementById('summary-total');
                list.innerHTML = '';
                checkoutState.cart.forEach(item => {
                    list.innerHTML += `<div class="summary-item"><img src="${item.imageUrl}" alt="${item.name}"><div class="summary-item-info"><strong>${item.name}</strong><span>Qty: ${item.quantity}</span></div><span>${formatCurrency(item.price*item.quantity)}</span></div>`;
                });
                const subtotal = checkoutState.cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
                const shippingCost = checkoutState.deliveryOption ? checkoutState.deliveryOption.cost : 0;
                const tax = subtotal * TAX_RATE;
                const total = subtotal + shippingCost + tax;
                subtotalEl.textContent = formatCurrency(subtotal);
                shippingEl.textContent = checkoutState.deliveryOption ? formatCurrency(shippingCost) : '--';
                taxEl.textContent = formatCurrency(tax);
                totalEl.textContent = formatCurrency(total);
            }

            function goToStep(stepNumber) {
                checkoutState.currentStep = stepNumber;
                document.querySelectorAll('.checkout-step').forEach(step => step.classList.remove('active'));
                document.getElementById(`step-${stepNumber}`).classList.add('active');
                progressSteps.forEach(step => step.classList.toggle('active', parseInt(step.dataset.step) <= stepNumber));
                progressIndicator.style.width = stepNumber === 1 ? '0%' : stepNumber === 2 ? '50%' : '100%';
                backBtn.style.visibility = stepNumber > 1 ? 'visible' : 'hidden';
                if (stepNumber === 1) nextBtn.textContent = 'Next: Payment';
                else if (stepNumber === 2) nextBtn.textContent = 'Next: Review';
                else if (stepNumber === 3) nextBtn.textContent = 'Place Order & Send on WhatsApp';
            }

            function validateStep1() {
                shippingForm.querySelectorAll('input[required]').forEach(input => input.classList.remove('invalid'));
                let isValid = true;
                shippingForm.querySelectorAll('input[required]').forEach(input => {
                    if (!input.value.trim()) { input.classList.add('invalid'); isValid = false; }
                });
                return isValid;
            }

            function validateStep2() {
                if (!checkoutState.deliveryOption) { alert('Please select a delivery option.'); return false; }
                if (!checkoutState.paymentMethod) { alert('Please select a payment method.'); return false; }
                return true;
            }

            function saveShippingDetails() {
                checkoutState.shippingDetails = {
                    name: document.getElementById('name').value, address: document.getElementById('address').value,
                    city: document.getElementById('city').value, pincode: document.getElementById('pincode').value,
                    phone: document.getElementById('phone').value,
                };
                if (document.getElementById('save-address').checked) {
                    const addresses = getSavedAddresses();
                    if (!addresses.some(addr => addr.address.toLowerCase() === checkoutState.shippingDetails.address.toLowerCase())) {
                        addresses.push(checkoutState.shippingDetails);
                        saveAddresses(addresses);
                    }
                }
            }

            function populateReviewStep() {
                document.getElementById('review-address-details').innerHTML = `<strong>${checkoutState.shippingDetails.name}</strong><br>${checkoutState.shippingDetails.address}<br>${checkoutState.shippingDetails.city}, ${checkoutState.shippingDetails.pincode}<br>Phone: ${checkoutState.shippingDetails.phone}`;
                document.getElementById('review-payment-details').innerHTML = `<strong>Delivery:</strong> ${checkoutState.deliveryOption.name} Delivery (${formatCurrency(checkoutState.deliveryOption.cost)})<br><strong>Payment:</strong> ${checkoutState.paymentMethod}`;
            }

            function loadSavedAddresses() {
                const grid = document.getElementById('saved-address-grid');
                const addresses = getSavedAddresses();
                grid.innerHTML = '';
                document.getElementById('no-saved-address').style.display = addresses.length > 0 ? 'none' : 'block';
                addresses.forEach((addr, index) => {
                    grid.innerHTML += `<div class="saved-address" data-index="${index}"><strong>${addr.name}</strong><p>${addr.address}, ${addr.city}</p></div>`;
                });
                grid.querySelectorAll('.saved-address').forEach(div => {
                    div.addEventListener('click', (e) => {
                        const selectedAddr = addresses[e.currentTarget.dataset.index];
                        document.getElementById('name').value = selectedAddr.name;
                        document.getElementById('address').value = selectedAddr.address;
                        document.getElementById('city').value = selectedAddr.city;
                        document.getElementById('pincode').value = selectedAddr.pincode;
                        document.getElementById('phone').value = selectedAddr.phone;
                        grid.querySelectorAll('.saved-address').forEach(d => d.classList.remove('selected'));
                        e.currentTarget.classList.add('selected');
                    });
                });
            }
            
            function calculateDeliveryDates() {
                const options = { weekday: 'long', month: 'long', day: 'numeric' };
                const standardDate = new Date(new Date().setDate(new Date().getDate() + 5));
                const expressDate = new Date(new Date().setDate(new Date().getDate() + 2));
                document.getElementById('standard-delivery-estimate').textContent = `Est. Delivery: ${standardDate.toLocaleDateString('en-IN', options)}`;
                document.getElementById('express-delivery-estimate').textContent = `Est. Delivery: ${expressDate.toLocaleDateString('en-IN', options)}`;
            }
            
            function sendOrderToWhatsApp() {
                const orderId = `AC${Date.now()}`;
                const total = document.getElementById('summary-total').textContent;
                let message = `*New Order from AgriConnect!* 🎉\n\n*Order ID:* ${orderId}\n\n*Customer Details:*\nName: ${checkoutState.shippingDetails.name}\nAddress: ${checkoutState.shippingDetails.address}, ${checkoutState.shippingDetails.city}, ${checkoutState.shippingDetails.pincode}\nPhone: ${checkoutState.shippingDetails.phone}\n\n*Order Items:*\n`;
                checkoutState.cart.forEach(item => { message += `- ${item.name} (Qty: ${item.quantity}) - ${formatCurrency(item.price * item.quantity)}\n`; });
                message += `\n*Order Summary:*\nSubtotal: ${document.getElementById('summary-subtotal').textContent}\nShipping: ${document.getElementById('summary-shipping').textContent}\nTax: ${document.getElementById('summary-tax').textContent}\n*Total Amount:* ${total}\n\n*Payment Method:* ${checkoutState.paymentMethod}`;
                const encodedMessage = encodeURIComponent(message);
                const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodedMessage}`;
                
                document.getElementById('order-id').textContent = orderId;
                checkoutView.style.display = 'none';
                confirmationView.style.display = 'block';
                feather.replace();
                localStorage.removeItem('agriConnectCart');
                window.open(whatsappUrl, '_blank');
            }

            nextBtn.addEventListener('click', () => {
                if (checkoutState.currentStep === 1) {
                    if (validateStep1()) { saveShippingDetails(); goToStep(2); } 
                    else { alert('Please fill in all required shipping details.'); }
                } else if (checkoutState.currentStep === 2) {
                    if (validateStep2()) { populateReviewStep(); goToStep(3); }
                } else if (checkoutState.currentStep === 3) {
                    sendOrderToWhatsApp();
                }
            });

            backBtn.addEventListener('click', () => { if (checkoutState.currentStep > 1) goToStep(checkoutState.currentStep - 1); });
            
            document.getElementById('delivery-options').addEventListener('click', (e) => {
                const option = e.target.closest('.option-item');
                if (!option) return;
                document.querySelectorAll('#delivery-options .option-item').forEach(el => el.classList.remove('selected'));
                option.classList.add('selected');
                checkoutState.deliveryOption = { name: option.dataset.delivery, cost: parseInt(option.dataset.cost) };
                renderOrderSummary();
            });
            
            document.getElementById('payment-options').addEventListener('click', (e) => {
                const option = e.target.closest('.option-item');
                if (!option) return;
                document.querySelectorAll('#payment-options .option-item').forEach(el => el.classList.remove('selected'));
                document.querySelectorAll('.payment-details').forEach(el => el.style.display = 'none');
                option.classList.add('selected');
                const paymentDetails = document.getElementById(`${option.dataset.payment.replace(/ /g, "\\ " )}-details`);
                if(paymentDetails) paymentDetails.style.display = 'block';
                checkoutState.paymentMethod = option.dataset.payment;
            });

            function init() {
                checkoutState.cart = getCart();
                if (checkoutState.cart.length === 0) {
                    document.body.innerHTML = `<div class="card" style="margin: 50px auto; text-align: center; max-width: 500px;"><h2>Your Cart is Empty</h2><p>You need to add items to your cart before you can check out.</p><a href="buy.html" class="btn btn-primary" style="margin-top: 1rem;">Go to Marketplace</a></div>`;
                    return;
                }
                renderOrderSummary(); loadSavedAddresses(); calculateDeliveryDates(); goToStep(1);
            }

            init();
        });
    </script>
</body>
</html>